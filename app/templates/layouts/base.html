{% load staticfiles %}
<!doctype html>
<html>

{% block head %}
    <head>
        {% block meta %}
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <meta name="yandex-verification" content="e1c7be80f029b1a1"/>
            <meta name="yandex-verification" content="6d8061bc357b9fc4"/>
            <title>AnalogPro</title>
        {% endblock meta %}

        {% block css %}
            <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet" type="text/css">
            <!--===========================main css for  web host page===============================-->
            <link href="{% static 'css/style.css' %}" rel="stylesheet" title="stylesheet" media="screen">
            <link href="{% static 'css/style1.css' %}" rel="stylesheet" title="stylesheet1" media="screen">
            <link href="{% static 'css/style2.css' %}" rel="stylesheet" title="stylesheet2" media="screen">
            <link href="{% static 'css/style3.css' %}" rel="stylesheet" title="stylesheet3" media="screen">
            <link href="{% static 'css/style4.css' %}" rel="stylesheet" title="stylesheet4" media="screen">
            <link href="{% static 'css/style5.css' %}" rel="stylesheet" title="stylesheet5" media="screen">
            <link href="{% static 'css/style6.css' %}" rel="stylesheet" title="stylesheet6" media="screen">
            <link href="{% static 'css/style7.css' %}" rel="stylesheet" title="stylesheet7" media="screen">
            <!--==============THEME CSS=================-->
            <link href="{% static 'css/demo/demo.css' %}" rel="stylesheet" type="text/css">
            <link href="{% static 'css/font-awesome/css/font-awesome.min.css' %}" rel="stylesheet" type="text/css">
            <link href="{% static 'fonts/font/stylesheet.css' %}" rel="stylesheet" type="text/css">
            <!--==============Carousel CSS=================-->
            <link href="{% static 'css/owl.carousel.css' %}" rel="stylesheet" type="text/css">
            <!--=================================GOOGLE FONT - OPEN SANS==============================-->
            <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,800' rel='stylesheet'
                  type='text/css'>
            <link type="text/css" rel="stylesheet" href="{% static 'css/login-popup.css' %}"/>

            <link type="text/css" rel="stylesheet" href="{% static 'css/app.css' %}">
        {% endblock css %}

        {% block js %}
            <!--=============================jquery.js==============================-->
            <script src="{% static 'js/jquery-1.10.2.min.js' %}" type="text/javascript"></script>
            <!--============================= login-popup ==============================-->
            <script src="{% static 'js/jquery.leanModal.min.js' %}" type="text/javascript"></script>
            <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
            <!--[if lt IE 9]><script src="js2/ie8-responsive-file-warning.js"></script><![endif]-->

            <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
            <!--[if lt IE 9]>
            <script src="{% static 'js/html5shiv.js' %}"></script>
            <script src="{% static 'js/respond.min.js' %}"></script>
            <![endif]-->
            <!-- Custom styles for this template -->
        {% endblock js %}

        {% include 'scripts/yandex_metrika.html' %}

        <!-- Google recaptcha -->
        <script src='https://www.google.com/recaptcha/api.js'></script>
    </head>
{% endblock head %}

<body>
{% block content %}
    {% block header %}
        {% include 'includes/header.html' %}
    {% endblock header %}

    {% block carouser %}
        {% include 'sections/carousel.html' %}
    {% endblock carouser %}

    <!--=============================Separator block=============================-->
    {#<div class="seprator-block" style="height: 20px;"></div>#}
    {% block features %}
        {% include 'sections/features.html' %}
    {% endblock features %}

    <!--=============================Separator block=============================-->
{#<div class="seprator-block" style="height: 20px;"></div>#}

    <!--=============================Search by article=============================-->
    {% block search_article %}
        {% include 'sections/search_article.html' %}
    {% endblock search_article %}

    <!--=============================Specification Search=============================-->
    {% block search_specification %}
        {% include 'sections/search_specification.html' %}
    {% endblock search_specification %}

    <!--==============================Get in touch=============================-->
    {% block contact %}
        {% include 'sections/contact.html' %}
    {% endblock contact %}

    <!--==============================Newsletter=============================-->

<div class="newsletter-container" style="background-color: unset; padding: 10px">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="newsletter-background" style="background-size: cover;
    border-radius: 5px;height: 174px;
    background-image: linear-gradient( rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url({% static 'landing_images/item3.jpg' %});">
                    <div class="row">
                    <div class="col-sm-12 col-md-12 h2-newsletter">
{#                        <div class="newsletter"><span class="newsletterIcon"></span>#}
                            <h2 style="text-align: center">Подписаться на новости </h2>
{#                            <p>на новости </p>#}
{#                        </div>#}
                    </div></div>
                    <form class="form-search" id="subscribeForm" method="POST">
                        <div class="col-sm-8 col-md-4 col-md-offset-3">
                            {% csrf_token %}
                            {{ subscribe_form.email }}
                        </div>
                        <div class="col-sm-4 col-md-3">
                            <button type="submit" class="newsletter-btn">Подписаться</button>
                            <span id="result" class="alertMsg"></span></div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<!--==============================Footer============================-->
<!-- TODO: set footer -->
<!--===========================Goto top============================-->
<a href="#" id="go-top"></a>

<!--===============================Footer-bottom============================-->

<div class="footer-bottom">
    <div class="container">
        <div class="row">
            <div class="col-md-2">
                <img height="25px;" src="/static/landing_images/ezgif.com-gif-maker.png" alt="AnalogPro">
            </div>
            <div class="col-md-5 col-md-offset-5">
                    <div class="top-link footer-link">
                        <ul>
                            <li><a href="#" class="info-ico"><svg style="margin-right: 10px"  width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M21.1543 5H3.8457C2.82925 5 2 5.82835 2 6.8457V19.1504C2 20.1643 2.82556 20.9961 3.8457 20.9961H21.1543C22.1682 20.9961 23 20.1705 23 19.1504V6.8457C23 5.8318 22.1744 5 21.1543 5ZM20.8994 6.23047L12.5391 14.5908L4.10652 6.23047H20.8994ZM3.23047 18.8956V7.09463L9.15637 12.9697L3.23047 18.8956ZM4.10053 19.7656L10.0302 13.836L12.1079 15.8959C12.3484 16.1343 12.7365 16.1336 12.9761 15.894L15.002 13.8681L20.8995 19.7656H4.10053ZM21.7695 18.8956L15.872 12.998L21.7695 7.10049V18.8956Z" fill="#333333"/>
</svg><span>info@analogpro.ru</span>
</a></li>
                            <li><a href="tel:+74957403618" class="phone-ico"><svg style="margin-right: 10px" width="19"  height="19" viewBox="0 0 19 19"
                                         fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0)">
                                            <path d="M15.0158 11.7697C14.6269 11.3647 14.1577 11.1481 13.6604 11.1481C13.1672 11.1481 12.694 11.3607 12.289 11.7657L11.0218 13.0289C10.9175 12.9727 10.8133 12.9206 10.713 12.8685C10.5687 12.7963 10.4323 12.7281 10.316 12.6559C9.12905 11.902 8.05033 10.9196 7.01573 9.64837C6.51447 9.01478 6.17763 8.48143 5.93301 7.94007C6.26184 7.63932 6.5666 7.32653 6.86335 7.02577C6.97563 6.91349 7.08791 6.7972 7.2002 6.68492C8.04231 5.8428 8.04231 4.75206 7.2002 3.90994L6.10544 2.81519C5.98113 2.69088 5.85281 2.56256 5.73251 2.43423C5.4919 2.18561 5.23927 1.92896 4.97861 1.68836C4.58963 1.30339 4.12446 1.09888 3.63523 1.09888C3.14601 1.09888 2.67282 1.30339 2.27181 1.68836C2.2678 1.69237 2.2678 1.69237 2.26379 1.69638L0.90036 3.07184C0.38707 3.58513 0.094334 4.2107 0.0301728 4.93652C-0.0660692 6.10747 0.278798 7.19821 0.543463 7.912C1.1931 9.66441 2.16354 11.2885 3.61117 13.0289C5.36759 15.1261 7.4809 16.7823 9.89497 17.9492C10.8173 18.3863 12.0484 18.9036 13.4238 18.9919C13.5081 18.9959 13.5963 18.9999 13.6765 18.9999C14.6028 18.9999 15.3808 18.667 15.9903 18.0054C15.9943 17.9974 16.0023 17.9933 16.0063 17.9853C16.2149 17.7327 16.4555 17.5041 16.7081 17.2595C16.8805 17.0951 17.057 16.9227 17.2294 16.7422C17.6264 16.3292 17.8349 15.848 17.8349 15.3547C17.8349 14.8575 17.6224 14.3803 17.2174 13.9793L15.0158 11.7697ZM16.4515 15.9923C16.4474 15.9923 16.4474 15.9963 16.4515 15.9923C16.2951 16.1607 16.1347 16.3131 15.9622 16.4815C15.7016 16.7302 15.4369 16.9908 15.1883 17.2836C14.7833 17.7167 14.3061 17.9212 13.6805 17.9212C13.6203 17.9212 13.5562 17.9212 13.496 17.9172C12.305 17.841 11.1982 17.3758 10.3682 16.9788C8.09845 15.88 6.10544 14.3201 4.44928 12.3431C3.08184 10.695 2.16755 9.17117 1.56202 7.53506C1.18909 6.53655 1.05274 5.75859 1.11289 5.02475C1.153 4.55557 1.33345 4.16659 1.66629 3.83375L3.03372 2.46631C3.23022 2.28185 3.43874 2.1816 3.64326 2.1816C3.89589 2.1816 4.1004 2.33398 4.22873 2.4623C4.23274 2.46631 4.23675 2.47032 4.24076 2.47433C4.48537 2.70291 4.71796 2.9395 4.96257 3.19214C5.08688 3.32046 5.21521 3.44878 5.34353 3.58112L6.43828 4.67587C6.86335 5.10094 6.86335 5.49393 6.43828 5.91899C6.32199 6.03529 6.20971 6.15158 6.09341 6.26386C5.75657 6.60873 5.43576 6.92953 5.08688 7.24232C5.07886 7.25034 5.07084 7.25435 5.06683 7.26237C4.72197 7.60724 4.78613 7.94408 4.85831 8.17266C4.86232 8.18469 4.86633 8.19672 4.87034 8.20875C5.15506 8.89848 5.55606 9.54812 6.1656 10.3221L6.16961 10.3261C7.27639 11.6895 8.44332 12.7522 9.73056 13.5662C9.89497 13.6705 10.0634 13.7547 10.2238 13.8349C10.3682 13.9071 10.5045 13.9752 10.6208 14.0474C10.6368 14.0554 10.6529 14.0675 10.6689 14.0755C10.8053 14.1437 10.9336 14.1757 11.0659 14.1757C11.3988 14.1757 11.6073 13.9672 11.6754 13.8991L13.0469 12.5276C13.1832 12.3913 13.3998 12.2268 13.6524 12.2268C13.901 12.2268 14.1056 12.3832 14.2299 12.5196C14.2339 12.5236 14.2339 12.5236 14.2379 12.5276L16.4474 14.7372C16.8605 15.1462 16.8605 15.5672 16.4515 15.9923Z"
                                                  fill="black"/>
                                            <path d="M10.2679 4.51949C11.3185 4.69593 12.2729 5.19318 13.0348 5.95509C13.7967 6.71701 14.29 7.67141 14.4704 8.72205C14.5145 8.98671 14.7431 9.17118 15.0038 9.17118C15.0359 9.17118 15.0639 9.16717 15.096 9.16316C15.3928 9.11504 15.5893 8.83433 15.5411 8.53759C15.3246 7.26639 14.7231 6.10748 13.8048 5.18917C12.8865 4.27086 11.7275 3.66935 10.4563 3.4528C10.1596 3.40468 9.88291 3.60118 9.83078 3.89391C9.77865 4.18665 9.97113 4.47136 10.2679 4.51949Z"
                                                  fill="black"/>
                                            <path d="M18.9779 8.3813C18.621 6.28804 17.6345 4.38325 16.1187 2.86744C14.6029 1.35163 12.6981 0.36515 10.6049 0.00825334C10.3121 -0.0438777 10.0354 0.156626 9.98332 0.449362C9.9352 0.746108 10.1317 1.0228 10.4284 1.07493C12.2971 1.39173 14.0014 2.27796 15.3568 3.62936C16.7122 4.98476 17.5944 6.68905 17.9112 8.55774C17.9554 8.82241 18.1839 9.00687 18.4446 9.00687C18.4767 9.00687 18.5047 9.00286 18.5368 8.99885C18.8296 8.95474 19.0301 8.67404 18.9779 8.3813Z"
                                                  fill="black"/>
                                        </g>
                                        <g clip-path="url(#clip1)">
                                            <path d="M15.0158 11.7697C14.6269 11.3647 14.1577 11.1481 13.6604 11.1481C13.1672 11.1481 12.694 11.3607 12.289 11.7657L11.0218 13.0289C10.9175 12.9727 10.8133 12.9206 10.713 12.8685C10.5687 12.7963 10.4323 12.7281 10.316 12.6559C9.12905 11.902 8.05033 10.9196 7.01573 9.64837C6.51447 9.01478 6.17763 8.48143 5.93301 7.94007C6.26184 7.63932 6.5666 7.32653 6.86335 7.02577C6.97563 6.91349 7.08791 6.7972 7.2002 6.68492C8.04231 5.8428 8.04231 4.75206 7.2002 3.90994L6.10544 2.81519C5.98113 2.69088 5.85281 2.56256 5.73251 2.43423C5.4919 2.18561 5.23927 1.92896 4.97861 1.68836C4.58963 1.30339 4.12446 1.09888 3.63523 1.09888C3.14601 1.09888 2.67282 1.30339 2.27181 1.68836C2.2678 1.69237 2.2678 1.69237 2.26379 1.69638L0.90036 3.07184C0.38707 3.58513 0.094334 4.2107 0.0301728 4.93652C-0.0660692 6.10747 0.278798 7.19821 0.543463 7.912C1.1931 9.66441 2.16354 11.2885 3.61117 13.0289C5.36759 15.1261 7.4809 16.7823 9.89497 17.9492C10.8173 18.3863 12.0484 18.9036 13.4238 18.9919C13.5081 18.9959 13.5963 18.9999 13.6765 18.9999C14.6028 18.9999 15.3808 18.667 15.9903 18.0054C15.9943 17.9974 16.0023 17.9933 16.0063 17.9853C16.2149 17.7327 16.4555 17.5041 16.7081 17.2595C16.8805 17.0951 17.057 16.9227 17.2294 16.7422C17.6264 16.3292 17.8349 15.848 17.8349 15.3547C17.8349 14.8575 17.6224 14.3803 17.2174 13.9793L15.0158 11.7697ZM16.4515 15.9923C16.4474 15.9923 16.4474 15.9963 16.4515 15.9923C16.2951 16.1607 16.1347 16.3131 15.9622 16.4815C15.7016 16.7302 15.4369 16.9908 15.1883 17.2836C14.7833 17.7167 14.3061 17.9212 13.6805 17.9212C13.6203 17.9212 13.5562 17.9212 13.496 17.9172C12.305 17.841 11.1982 17.3758 10.3682 16.9788C8.09845 15.88 6.10544 14.3201 4.44928 12.3431C3.08184 10.695 2.16755 9.17117 1.56202 7.53506C1.18909 6.53655 1.05274 5.75859 1.11289 5.02475C1.153 4.55557 1.33345 4.16659 1.66629 3.83375L3.03372 2.46631C3.23022 2.28185 3.43874 2.1816 3.64326 2.1816C3.89589 2.1816 4.1004 2.33398 4.22873 2.4623C4.23274 2.46631 4.23675 2.47032 4.24076 2.47433C4.48537 2.70291 4.71796 2.9395 4.96257 3.19214C5.08688 3.32046 5.21521 3.44878 5.34353 3.58112L6.43828 4.67587C6.86335 5.10094 6.86335 5.49393 6.43828 5.91899C6.32199 6.03529 6.20971 6.15158 6.09341 6.26386C5.75657 6.60873 5.43576 6.92953 5.08688 7.24232C5.07886 7.25034 5.07084 7.25435 5.06683 7.26237C4.72197 7.60724 4.78613 7.94408 4.85831 8.17266C4.86232 8.18469 4.86633 8.19672 4.87034 8.20875C5.15506 8.89848 5.55606 9.54812 6.1656 10.3221L6.16961 10.3261C7.27639 11.6895 8.44332 12.7522 9.73056 13.5662C9.89497 13.6705 10.0634 13.7547 10.2238 13.8349C10.3682 13.9071 10.5045 13.9752 10.6208 14.0474C10.6368 14.0554 10.6529 14.0675 10.6689 14.0755C10.8053 14.1437 10.9336 14.1757 11.0659 14.1757C11.3988 14.1757 11.6073 13.9672 11.6754 13.8991L13.0469 12.5276C13.1832 12.3913 13.3998 12.2268 13.6524 12.2268C13.901 12.2268 14.1056 12.3832 14.2299 12.5196C14.2339 12.5236 14.2339 12.5236 14.2379 12.5276L16.4474 14.7372C16.8605 15.1462 16.8605 15.5672 16.4515 15.9923Z"
                                                  fill="#333333"/>
                                            <path d="M10.2679 4.51949C11.3185 4.69593 12.2729 5.19318 13.0348 5.95509C13.7967 6.71701 14.29 7.67141 14.4704 8.72205C14.5145 8.98671 14.7431 9.17118 15.0038 9.17118C15.0359 9.17118 15.0639 9.16717 15.096 9.16316C15.3928 9.11504 15.5893 8.83433 15.5411 8.53759C15.3246 7.26639 14.7231 6.10748 13.8048 5.18917C12.8865 4.27086 11.7275 3.66935 10.4563 3.4528C10.1596 3.40468 9.88291 3.60118 9.83078 3.89391C9.77865 4.18665 9.97113 4.47136 10.2679 4.51949Z"
                                                  fill="#333333"/>
                                            <path d="M18.9779 8.3813C18.621 6.28804 17.6345 4.38325 16.1187 2.86744C14.6029 1.35163 12.6981 0.36515 10.6049 0.00825334C10.3121 -0.0438777 10.0354 0.156626 9.98332 0.449362C9.9352 0.746108 10.1317 1.0228 10.4284 1.07493C12.2971 1.39173 14.0014 2.27796 15.3568 3.62936C16.7122 4.98476 17.5944 6.68905 17.9112 8.55774C17.9554 8.82241 18.1839 9.00687 18.4446 9.00687C18.4767 9.00687 18.5047 9.00286 18.5368 8.99885C18.8296 8.95474 19.0301 8.67404 18.9779 8.3813Z"
                                                  fill="#333333"/>
                                        </g>
                                        <defs>
                                            <clipPath id="clip0">
                                                <rect width="19" height="19" fill="white"/>
                                            </clipPath>
                                            <clipPath id="clip1">
                                                <rect width="19" height="19" fill="white"/>
                                            </clipPath>
                                        </defs>
                            </svg><span>+7(495) 740 36 18</span></a></li>
                        </ul>
                    </div>
            </div>
        </div>
        <div class="row">
            <p>© 2019 analogpro.ru. All Rights Reserved</p>
        </div>
    </div>
</div>

<script type="text/javascript">
    //Working with cookie

    function createCookie(cookieName, cookieValue, daysToExpire) {
        var date = new Date();
        date.setTime(date.getTime() + (daysToExpire * 24 * 60 * 60 * 1000));
        document.cookie = cookieName + "=" + cookieValue + "; expires=" + date.toGMTString();
    }

    function accessCookie(cookieName) {
        var name = cookieName + "=";
        var allCookieArray = document.cookie.split(';');
        for (var i = 0; i < allCookieArray.length; i++) {
            var temp = allCookieArray[i].trim();
            if (temp.indexOf(name) == 0)
                return temp.substring(name.length, temp.length);
        }
        return "";
    }
</script>

<script type="text/javascript">

    /*===================
     OWL Carousel
      ===================*/

    jQuery(document).ready(function () {
        var carousel = $('#myCarousel')
        jQuery("#myCarousel").click(function () {
            carousel.carousel('pause');
        })
    });


</script>

<!--============== Form validation JS=================-->

<script src="{% static 'js/contact_form.js' %}" type="text/javascript"></script>

<!--============================Sticky.js===========================-->

<script src="{% static 'js/jquery.sticky.js' %}" type="text/javascript"></script>

<!--============================Main.js===========================-->

<script src="{% static 'js/main.js' %}" type="text/javascript"></script>

<!--=========================Scroll.js=========================-->

<script src="{% static 'js/scroll.js' %}" type="text/javascript"></script>

<!--========================Lettering.js========================-->

{#<script type="text/javascript" src="{% static 'js2/jquery.lettering.js' %}"></script>#}

<!--========================Carousel.js slider=======================-->

<script src="{% static 'js/owl.carousel.js' %}" type="text/javascript"></script>

<!--====================Theme change js=========================-->

<script type="text/javascript" src="{% static 'css/demo/styleswitch.js' %}"></script>

<!--==============Ketchup=================-->

<script src="{% static 'js/ketchup.all.js' %}" type="text/javascript"></script>

<!--============================Bootstrap==========================-->

<script src="{% static 'js/bootstrap.min.js' %}" type="text/javascript"></script>

<!--============================Sweetalert==========================-->

<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<script type="text/javascript">
    /*===================
  3.popup sign in & register
   ===================*/


    $("#login-menu").leanModal({top: 130, overlay: 0.6, closeButton: ".modal_close"});

    $(function () {
        // Calling Login Form
        $("#login_form").click(function () {
            $(".social_login").hide();
            $(".user_login").show();
            return false;
        });

        // Calling Register Form
        $("#register_form").click(function () {
            $(".social_login").hide();
            $(".user_register").show();
            $(".header_title").text('Регистрация');
            return false;
        });

        // Going back to Social Forms
        $(".back_btn").click(function () {
            $(".user_login").hide();
            $(".user_register").hide();
            $(".social_login").show();
            $(".header_title").text('Авторизация');
            return false;
        });

    })
</script>

<script type="text/javascript">
    $(function () {
        /*===================
        User subscribe form
         ====================*/
        var subscribe_form = $('#subscribeForm');
        subscribe_form.submit(function (e) {
            e.preventDefault();
            $.ajax({
                type: "POST",
                url: "{% url 'api:subscriber' %}",
                data: subscribe_form.serialize(),
                success: function (response) {
                    if (response.OK) {
                        $('#result').html('Спасибо, вы успешно подписаны.');
                    }
                    else {
                        $('#result').html(response.error);
                    }
                },
                error: function (error) {
                    $('#result').html("Произошла ошибка.");
                }
            })
        })

        /*===================
        User login form
         ====================*/
        var login_form = $('#user_login_form');
        login_form.submit(function (e) {
            e.preventDefault();
            $.ajax({
                type: "POST",
                url: "{% url 'api:login' %}",
                data: login_form.serialize(),
                success: function (response) {
                    if (response.OK) {
                        location.reload();
                    }
                    else {
                        $('#error_user_login_form').text(response.error)
                    }
                },
                error: function (error) {
                    $('#error_user_login_form').text("Произошла ошибка.")
                }
            })
        })

        /*===================
        User registration form
         ====================*/
        var register_form = $('#user_register_form');
        register_form.submit(function (e) {
            var is_success = false;
            var username = $("#user_register_form #id_username");
            var email = $("#user_register_form #id_email");
            var id_password = $("#user_register_form #id_password");
            var id_double_password = $("#user_register_form #id_double_password");
            e.preventDefault();
            console.log(id_password.val(), id_double_password.val(), id_double_password.val().length > 7)
            if ((id_password.val() === id_double_password.val()) &&
                (id_password.val().length > 7) && (id_double_password.val().length > 7)) {
                is_success = true;

            }
            else {
                $("#passwordHelp").text('Пароли не совпадают или длина меньше 8 символов').css('display', 'block');
                $("#password_check").addClass('has-error')
            }
            if (is_success === true) {
                $.ajax({
                    type: "POST",
                    url: "{% url 'api:registration' %}",
                    data: register_form.serialize(),
                    success: function (response) {
                        if (response.OK) {
                            $('#modal').hide();
                            swal('Благодарим за регистрацию, '
                                + username.val()
                                + '. Пройдите по ссылке, отправленной вам на почту - ' + email.val()
                                + ', чтобы подтвердить аккаунт');

                            setTimeout(function () {
                                location.reload()
                            }, 3000);
                        }
                        else {
                            $('#error_user_login_form').text(response.error)
                        }
                    },
                    error: function (error) {
                        $('#error_user_login_form').text("Произошла ошибка регистрации.")
                    }
                })
            }
        })

    })
</script>

<script type="text/javascript">
    $(function () {
        /*==================
         Analogue search from file
         ==================*/

        $('#file-upload').change(function () {
            if ($(this).val() !== '') $(this).prev().text('Выбран файл: ' + $(this)[0].files[0].name);
            else $(this).prev().text('Загрузить файл');
        });

        var specification_search_form = $('#specification_search_form');

        specification_search_form.submit(function (e) {
            e.preventDefault();

            if ($('#file-upload')[0].files.length === 0) {
                swal("Внимание", "Пожалуйста, выберите файл!", "info");
                return '';
            }

            {% if not request.user.is_authenticated %}
                swal("Внимание", "Пожалуйста, авторизуйтесь, чтобы продолжить пользоваться сервисом", "info");
                return '';
            {% endif %}

            var data = new FormData();
            data.append('file', $('#file-upload')[0].files[0]);
            data.append('data', specification_search_form.serialize());
            data.append('csrfmiddlewaretoken', '{{ csrf_token }}');
            data.append('manufacturer_to', $('#manufacturer_to').val());
            {#console.log(data)#}
            {#        for(let [name, value] of data) {#}
            {#  console.log(`${name} = ${value}`);#}
            {# } #}
            $.ajax({
                type: "POST",
                url: "{% url 'app:search_from_file' %}",
                data: data,
                cache: false,
                async: true,
                processData: false,
                contentType: false,
                enctype: 'multipart/form-data',
                success: function (data) {
                    if (data.OK) {
                        var link = document.createElement("a");
                        link.href = "/" + data.file;
                        link.text = "скачать";
                        swal('Файл с результатом поиска отправлен на почту {{ request.user.email }} ' + '\n или вы можете скачать его по ссылке ниже:', {
                            content: link
                        })
                    }
                    else {
                        swal('Произошла ошибка')
                    }
                },
                error: function (error) {
                    swal('Произошла ошибка')
                }
            })


        });
        /*==================
         Analogue search from article
         ==================*/

        var form = $('#form');
        form.submit(function (e) {
            e.preventDefault();

            var attempt_count = +accessCookie('attempt_count');
            {% if not request.user.is_authenticated %}
                if (attempt_count > 10) {
                    swal("Ошибка!", "Пожалуйста, авторизуйтесь, чтобы продолжить пользоваться сервисом", "info");
                    {#$('#modal').modal("toggle");#}
                    return '';
                }
            {% endif %}

            $.ajax({
                type: "POST",
                url: "{% url 'api:search' %}",
                {#async: false,#}
                data: form.serialize(),
                success: function (data) {
                    if (data.error) {
                        {#alert(data.error);#}
                        swal("Внимание!", data.error, "info");
                    }
                    else {
                        createCookie("attempt_count", attempt_count + 1, 10);

                        function buildTable(data) {
                            var table = document.createElement("table");
                            table.className = "table table-hover mb-0";
                            table.id = 'table-info';
                            {#table.visible = false;#}
                            table.style.display = "none";
                            var thead = document.createElement("thead");
                            var tbody = document.createElement("tbody");
                            var headRow = document.createElement("tr");
                            {#Object.keys(data[0]).forEach(function (el) {#}
                            {#    var th = document.createElement("th");#}
                            {#    th.appendChild(document.createTextNode(el));#}
                            {#    headRow.appendChild(th);#}
                            {# });#}
                            thead.appendChild(headRow);
                            table.appendChild(thead);
                            data.forEach(function (el) {
                                var tr = document.createElement("tr");
                                {#for (var o in el) {#}
                                    var td1 = document.createElement("td");
                                    td1.appendChild(document.createTextNode(el["original"]["name"]));
                                    tr.appendChild(td1);
                                    var td2 = document.createElement("td");
                                    td2.appendChild(document.createTextNode(el["original"]["value"]));
                                    tr.appendChild(td2);
                                    var td3 = document.createElement("td");
                                    td3.appendChild(document.createTextNode(el["analog"]["value"]));
                                    tr.appendChild(td3);
                                {# }#}
                                tbody.appendChild(tr);
                            });
                            table.appendChild(tbody);
                            return table;
                        }

                        swal("Артикул: " + data.result.join(' ;'), {
                            content: buildTable(data.info),
                            buttons: {
                                cancel: "Закрыть",
                                catch: {
                                    id: "22",
                                    text: "Показать информацию",
                                    value: "select",
                                    closeModal: false
                                },
                                error: {
                                    text: "Сообщить об ошибке",
                                    value: "report_an_error",
                                    className: "report_an_error_class"
                                }
                                {#defeat: true,#}
                            }
                        }).then(function (value) {
                            switch (value) {

                                case "select":
                                    $('#table-info').show('slow');
                                    swal.stopLoading();
                                    $('.swal-button--catch').css('display', 'none');
                                    $('.report_an_error_class').css('display', 'block')
                                        .click(function () {
                                            {#swal.stopLoading();#}
                                            {#console.log('click enabled!, swal!!')#}
                                            swal("Спасибо", "Вы можете оставить свою почту и мы вам сообщим, " +
                                                "как только исправим неточность", {
                                                content: {
                                                    element: "input",
                                                    attributes: {
                                                        placeholder: "Введите ваш email",
                                                        type: "email",
                                                        id: "email_for_report_an_error",
                                                    }
                                                }
                                            }).then(function () {
                                                $.ajax({
                                                    type: "POST",
                                                    url: "{% url 'api:report_an_error' %}",
                                                    {#async: false,#}
                                                    data: JSON.stringify(
                                                        {'report': 'an_error',
                                                        'result_pk': data['result_pk'],
                                                        'original_pk': data['original_pk'],
                                                        'email': $('#email_for_report_an_error').val()})
                                                })
                                            });
                                        });
                                    break;
                                case "report_an_error":
                                {#swal.stopLoading();#}
                                    swal("Спасибо", "Вы можете оставить свою почту и мы вам сообщим, " +
                                        "как только исправим неточность", {
                                        content: {
                                            element: "input",
                                            attributes: {
                                                placeholder: "Введите ваш email",
                                                type: "email"
                                            }
                                        }
                                    }).then(function () {
                                        $.ajax({
                                            type: "POST",
                                            url: "{% url 'api:report_an_error' %}",
                                            {#async: false,#}
                                            data: data
                                        })
                                    });
                                    break;

                                default:
                                    swal.close();
                                    break;
                            }
                        });
                    }
                    console.log('Success', data);

                },
                error: function (data) {
                    swal("Сбой поиска!", "Произошла системная ошибка", "warning");
                    {#alert('Произошла системная ошибка');#}
                    console.log('Error', data)
                }
            })
        });


        /*==================
         Select manufacturer
         ==================*/
        var manufactures = $('.manufacturers');
        $('#btn_manufacturer_article').attr('data-id_manufacturer', manufactures[0].id)
            .html(manufactures[0].text + '<span class="caret"></span>');
        $('#btn_manufacturer_file').attr('data-id_manufacturer', manufactures[0].id)
            .html(manufactures[0].text + '<span class="caret"></span>');

        manufactures.click(function (self) {
            console.log(self.target.id, self);
            $('#btn_manufacturer_file').html(self.target.text + '<span class="caret"></span>')
                .attr('data-id_manufacturer', self.target.id);
            $('#btn_manufacturer_article').html(self.target.text + '<span class="caret"></span>')
                .attr('data-id_manufacturer', self.target.id);
            $('#manufacturer_to').val(self.target.id);
        })
    });
</script>
<!--=============================jquery ui.css==============================-->
<link rel="stylesheet" href="{% static 'css/jquery-ui.css' %}">
<!--=============================jquery ui.js==============================-->
<script src="{% static 'js/jquery-ui.js' %}"></script>

<style>
    .ui-autocomplete {
        max-height: 150px;
        overflow-y: auto;
        /* prevent horizontal scrollbar */
        overflow-x: hidden;
    }

    .ui-autocomplete-loading {
        background: white url("{% static 'landing_images/ui-anim_basic_16x16.gif' %}") right center no-repeat;
    }

    .ui-menu-item:active {
        background: #FFDD40 !important;
    }

    .ui-menu-item:hover {
        background: #FFDD40 !important;
    }

    .ui-menu-item:focus {
        background: #FFDD40 !important;
    }
</style>
<style>
    .swal-modal {
        width: 580px;
    }
    .report_an_error_class {
        background-color: #fddc3f;
        display: none;
    }
    .report_an_error_class:hover {
        background-color: #E0C239!important;
    }
</style>
<script type="text/javascript">
    $(function () {
        /*==================
         Jquery autocomplete
         ==================*/
    $("#article").autocomplete({
        source: function (request, response) {
            $.ajax({
                type: "GET",
                url: "{% url 'api:search_article' %}",
                data: {
                    article: request.term
                },
                success: function (data) {
                    console.log(data);
                    response(data);

                }
            });

        },
        minLength: 2,
        select: function( event, ui ) {
            console.log(event, ui);
            {#console.log( "Selected: " + ui.item.value + " aka " + ui.item.id );#}
        }
    })
        .autocomplete("instance")._renderItem = function (ul, item) {
        return $("<li>")
            .append("<div>" + item.value + " (" + item.manufacturer__title + ") " + "<br>" + item.title + "</div>")
            .appendTo(ul);
    };

        /*==================
        Check registration
        ==================*/
        {% if confirm_email %}
            swal('Спасибо за регистрацию, {{ request.user }}. Ваш аккаунт подтверждён');
            setTimeout(function () {
                window.location.href = "{% url 'app:landing_home' %}"
            }, 3000);

        {% endif %}
    });

    function redirect(url) {
    window.location.href = url;
}
</script>
</body>
{% endblock content %}
</html>
